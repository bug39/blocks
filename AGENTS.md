AGENTS.md - Repo Guide for Coding Agents

Purpose
- This repo contains the hackathon plan and deliverables for "Unblocker Lite".
- Your goal is to implement the MVP defined in plan_v3_1.md with the checklist in implementation_checklist.md.

Primary references (read first)
- plan_v3_1.md
- implementation_checklist.md

Non-negotiables
- watsonx Orchestrate is the workflow runtime and approval/audit substrate.
- MVP scope: Flow A (why) + Pattern Wizard + /unblock scan. GitHub + Slack only. No Jira.
- Do not introduce extra flows, extra rules, or UI beyond Slack messages.
- Avoid scope drift. If in doubt, ask.

Project expectations
- Keep changes minimal and demo-focused.
- Favor deterministic logic for triggers and a strict policy gate.
- AI should be used for reviewer ranking + PR summary only (not stall classification).

Suggested structure (if building backend)
- app/main.py (FastAPI entry)
- app/github.py (GitHub API calls)
- app/rules.py (S2 + suppression)
- app/reviewers.py (candidate ladder)
- app/ai.py (ranking + summary)
- app/policy.py (policy gate)

Quickstart (expected commands)
1) uvicorn app.main:app --reload
2) curl http://localhost:8000/healthz  -> {"status":"ok"}
3) curl -X POST http://localhost:8000/analyze -H "Content-Type: application/json" -d '{"pr_url":"<PR_URL>", "run_id":"orch_123"}'
4) curl -X POST http://localhost:8000/analyze -H "Content-Type: application/json" -d '{"mode":"scan", "run_id":"orch_456"}'
5) curl -X POST http://localhost:8000/wizard -H "Content-Type: application/json" -d '{"input":"If PR has no reviewers after 2 hours, request reviewers from CODEOWNERS", "run_id":"orch_789"}'

Guardrails
- No Jira integration in MVP.
- No automated/scheduled Flow B (background queue scanning). Manual /unblock scan is in scope.
- No S3 unless MVP is complete and stable.
- No database migrations; use CREATE TABLE IF NOT EXISTS.
- No UI beyond Slack cards/messages.

Orchestrate Centrality (non-negotiable for hackathon)
- run_id MUST come from Orchestrate (backend rejects requests without it)
- Approval decision is made by Orchestrate (backend returns approval_required flag)
- Flow definition exists in orchestrate/flow_a.yaml
- Audit trail lives in Orchestrate run trace

Demo-critical outcomes
- Orchestrate run_id is passed to backend (not generated by backend)
- Approval gating is visible in Orchestrate flow
- /unblock why <PR_URL> shows Orchestrate making the decision
- Run trace shows: analyze -> approval_gate -> execute -> outcome
- /unblock scan returns top stalled PRs.
- Pattern Wizard parses NL rule and activates config.

Testing
- No formal test suite required for MVP.
- Minimum smoke tests: /healthz, /fetch_evidence, end-to-end Flow A.

Environment/config (if applicable)
- GITHUB_TOKEN (read + request reviewers + comment)
- SLACK_BOT_TOKEN (send/receive messages)
- BACKEND_SHARED_SECRET (if protecting endpoints)
- ORCHESTRATE_RUN_ID (passed by Orchestrate for correlation)

Style and code hygiene
- Keep modules small and focused.
- Prefer clear, explicit naming over abstraction.
- Add comments only where logic is non-obvious.

If blocked
- Ask for clarification rather than adding scope or assuming new requirements.
